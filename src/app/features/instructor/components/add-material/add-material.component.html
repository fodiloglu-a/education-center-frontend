<!-- Error Alert -->
<div *ngIf="error" class="error-alert">
    <div class="error-content">
        <span class="error-icon">‚ö†Ô∏è</span>
        <span class="error-message">{{ error }}</span>
        <button class="error-close" (click)="clearError()">√ó</button>
    </div>
</div>

<!-- Upload Section -->
<div class="upload-container">
    <div
            class="upload-zone"
            [class.drag-over]="dragOver"
            [class.loading]="isLoading"
            (dragover)="onDragOver($event)"
            (dragleave)="onDragLeave($event)"
            (drop)="onDrop($event)"
    >
        <div class="upload-content">
            <div class="upload-icon">üì§</div>
            <h3>{{ 'UPLOAD_YOUR_FILES' | translate }}</h3>
            <p>{{ 'UPLOAD_INSTRUCTIONS' | translate }}</p>

            <label for="uploadInput" class="upload-button">
                <span *ngIf="!isLoading">{{ 'SELECT_FILE' | translate }}</span>
                <span *ngIf="isLoading">{{ 'UPLOADING' | translate }}</span>
            </label>

            <input
                    id="uploadInput"
                    type="file"
                    multiple
                    accept="image/*,video/*"
                    (change)="onFileSelected($event)"
                    hidden
            >

            <div class="upload-info">
                <small>{{ 'SUPPORTED_FORMATS' | translate }}</small>
                <small>{{ 'MAX_FILE_SIZE' | translate }}</small>
            </div>
        </div>

        <!-- Upload Progress -->
        <div *ngIf="isLoading && uploadProgress > 0" class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="uploadProgress"></div>
            </div>
            <span class="progress-text">{{ uploadProgress.toFixed(0) }}%</span>
        </div>
    </div>
</div>

<!-- Loading Spinner -->
<div *ngIf="isLoading && uploadProgress === 0" class="loading-spinner">
    <div class="spinner"></div>
    <p>{{ 'LOADING_MEDIA_FILES' | translate }}</p>
</div>

<!-- Empty State -->
<div *ngIf="!isLoading && mediaList.length === 0" class="empty-state">
    <div class="empty-icon">üìÅ</div>
    <h3>{{ 'NO_FILES_UPLOADED' | translate }}</h3>
    <p>{{ 'UPLOAD_FIRST_FILE' | translate }}</p>
</div>

<!-- Media Grid -->
<div *ngIf="mediaList.length > 0" class="media-container">
    <div class="media-header">
        <h2>{{ 'MY_MEDIA_FILES' | translate }}</h2>
        <span class="media-count">{{ mediaList.length }} {{ 'FILES' | translate }}</span>
    </div>

    <div class="media-grid">
        <div class="media-card" *ngFor="let url of mediaList; trackBy: trackByUrl">
            <!-- Media Preview -->
            <div class="media-preview">
                <ng-container *ngIf="isVideo(url)">
                    <video
                            controls
                            [src]="url"
                            preload="metadata"
                            class="media-element"
                    ></video>
                    <div class="media-overlay">
                        <span class="media-type-badge video-badge">{{ getFileIcon(url) }} {{ getFileType(url) }}</span>
                    </div>
                </ng-container>

                <ng-container *ngIf="isImage(url)">
                    <img
                            [src]="url"
                            [alt]="extractFilename(url)"
                            class="media-element"
                            loading="lazy"
                    >
                    <div class="media-overlay">
                        <span class="media-type-badge image-badge">{{ getFileIcon(url) }} {{ getFileType(url) }}</span>
                    </div>
                </ng-container>
            </div>

            <!-- Media Info -->
            <div class="media-info">
                <h4 class="media-filename" [title]="extractFilename(url)">
                    {{ extractFilename(url) }}
                </h4>
            </div>

            <!-- Media Actions -->
            <div class="media-actions">
                <div class="action-row">
                    <button
                            class="action-btn primary"
                            (click)="copyUrl(url)"
                            [title]="'COPY_URL' | translate"
                    >
                        <span class="btn-icon">üìã</span>
                        <span class="btn-text">{{ 'COPY' | translate }}</span>
                    </button>

                    <button
                            class="action-btn secondary"
                            (click)="downloadMedia(url)"
                            [title]="'DOWNLOAD' | translate"
                    >
                        <span class="btn-icon">‚¨áÔ∏è</span>
                        <span class="btn-text">{{ 'DOWNLOAD' | translate }}</span>
                    </button>
                </div>

                <div class="action-row">
                    <label class="action-btn warning" [title]="'UPDATE' | translate">
                        <span class="btn-icon">üîÅ</span>
                        <span class="btn-text">{{ 'UPDATE' | translate }}</span>
                        <input
                                type="file"
                                accept="image/*,video/*"
                                (change)="updateMedia(url, $event)"
                                hidden
                        >
                    </label>

                    <button
                            class="action-btn danger"
                            (click)="deleteMedia(url)"
                            [title]="'DELETE' | translate"
                    >
                        <span class="btn-icon">üóëÔ∏è</span>
                        <span class="btn-text">{{ 'DELETE' | translate }}</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>